import{$b as f,$f as be,Ab as T,Ac as U,Dc as G,Hb as p,Jb as y,Lb as d,Lf as de,Mf as le,Na as l,Nf as ae,Of as se,Sb as j,Sf as ce,Tb as H,Uf as me,Vb as q,Vf as he,Wb as z,Wf as ue,Yb as w,Yc as J,Yf as pe,Za as L,Zb as b,Zf as Ce,_f as ge,cb as B,cc as E,db as S,dc as I,ec as V,hd as X,if as Z,kf as $,la as m,ma as h,nb as M,nf as ee,ob as D,pf as te,qb as O,qe as Y,qf as ne,rb as C,sb as g,sf as oe,ta as F,tb as A,tc as N,tf as ie,uc as s,vb as R,vc as K,wb as W,xb as u,xf as re,yb as a,yc as Q,zb as c,zc as _}from"./chunk-TLVTXGXZ.js";import{a as v,b as k}from"./chunk-ARLR7ZLP.js";var fe=["popoverComponentId"],_e=()=>[P];function xe(o,t){if(o&1){let e=p();a(0,"ng-icon",12),y("longclick",function(i){m(e);let r=d();return h(r.onToggleState(i))}),c()}if(o&2){let e=d();z("rotate-90",e.computedOpen())}}function ve(o,t){o&1&&T(0,"div",3)}function ke(o,t){if(o&1&&T(0,"hlm-checkbox",8),o&2){let e=d();u("disabled",e.node().disabled)("checked",e.isChecked())}}function ye(o,t){if(o&1&&(a(0,"label",10),b(1),c()),o&2){let e=d();l(),f(" ",e.node().secondTitle," ")}}function Te(o,t){if(o&1&&(a(0,"div",13),b(1,"..."),c(),a(2,"div"),b(3),c()),o&2){let e,n=d(2);l(2),w(n.metaClass()),l(),f(" ",(e=n.node().meta)==null?null:e.value," ")}}function we(o,t){if(o&1&&C(0,Te,4,3),o&2){let e,n=d();g((e=n.node().meta)!=null&&e.value||((e=n.node().meta)==null?null:e.value)===0?0:-1)}}function Ee(o,t){if(o&1){let e=p();a(0,"global-number-slider",17),V("valueChange",function(i){m(e);let r=d(3);return I(r.node().meta.value,i)||(r.node().meta.value=i),h(i)}),c()}if(o&2){let e=d(3);E("value",e.node().meta.value),u("step",e.node().meta.step)("wheelStep",e.node().meta.wheelStep)("label",e.node().meta.label)("hideButtons",e.node().meta.hideButtons)("hideReset",e.node().meta.hideReset)("disabled",e.node().meta.disabled)("max",e.node().meta.max)("min",e.node().meta.min)("hideDeleteButton",!0)}}function Ie(o,t){if(o&1){let e=p();a(0,"label",16),b(1),a(2,"input",18),V("ngModelChange",function(i){m(e);let r=d(3);return I(r.node().meta.value,i)||(r.node().meta.value=i),h(i)}),c()()}if(o&2){let e=d(3);l(),f("",e.node().meta.label," "),l(),E("ngModel",e.node().meta.value),u("type",e.node().meta.type)("disabled",e.node().meta.disabled)("placeholder",e.node().meta.placeholder)}}function Ve(o,t){if(o&1){let e=p();a(0,"label",16),b(1),a(2,"input",19),V("ngModelChange",function(i){m(e);let r=d(3);return I(r.node().meta.value,i)||(r.node().meta.value=i),h(i)}),c()()}if(o&2){let e=d(3);l(),f("",e.node().meta.label," "),l(),E("ngModel",e.node().meta.value),u("min",e.node().meta.min)("max",e.node().meta.max)("disabled",e.node().meta.disabled)("placeholder",e.node().meta.placeholder)}}function Ne(o,t){if(o&1&&C(0,Ee,1,10,"global-number-slider",15)(1,Ie,3,5,"label",16)(2,Ve,3,6,"label",16),o&2){let e=d(2);g(e.isTreeNumberSlider()?0:e.isTreeString()?1:e.isTreeNumber()?2:-1)}}function Se(o,t){if(o&1){let e=p();a(0,"div",14),y("keydown.enter",function(){m(e);let i=d();return h(i.onPopoverEnter())}),C(1,Ne,3,1),c()}if(o&2){let e=d();l(),g(e.hasValue()?1:-1)}}function Me(o,t){if(o&1){let e=p();a(0,"global-checkbox-tree-element",20),y("changed",function(i){m(e);let r=d(2);return h(r.emitChangesOfChilds(i))}),c()}if(o&2){let e=d(),n=e.$implicit,i=e.$index,r=d();q("max-height",r.computedOpen()?r.height():"0px")("opacity",r.computedOpen()?"1":"0"),u("node",n)("internalId",r.getInternalId(i))("rootLength",r.rootLength())("isVisible",r.computedOpen()&&r.isVisible())("setChecked",r.setChildsChecked())("metaVisibility",r.metaVisibility())}}function De(o,t){o&1&&(S(0,Me,1,10),M(1,0,_e),D())}var P=class o{node=G.required();internalId=_.required();rootLength=_.required();changed=Q();setChecked=_();isVisible=_.required();metaVisibility=_("hover");popover=U("popoverComponentId");#t=24;internalIdPrefix="TREE";constructor(){K(()=>{this.setChecked()!==void 0&&N(()=>{let e=this.node().checked;this.node().disabled||(e!==void 0&&(e()?e.set(!1):e.set(!0)),this.emitChangesOfChilds(this.node()))})})}getInternalId(t){return[...this.internalId(),t]}computedClass=s(()=>{let t="flex flex-col pl-3 first:pl-3 first:border-l-0 border-l duration-200 overflow-hidden duration-200 ease-in-out origin-top animate-fadeIn ";return this.metaVisibility()==="hover"?t+="border-transparent group-hover:border-border group-focus:border-border group-hover:opacity-100 group-focus:opacity-100 ":t+="border-border opacity-100 ",t});metaClass=s(()=>{let t="elite-text-tiny line-clamp-1 pl-2 duration-200 ";return this.metaVisibility()==="hover"?t+="opacity-0 group-hover:opacity-100 group-focus:opacity-100 ":t+="border-border ",t});internalIdAsString=s(()=>this.internalId().join("."));setChildsChecked=F(void 0);computedOpen=s(()=>this.node().state()==="open"&&(!this.hasCheckbox()||this.isChecked()===!0||this.isChecked()==="indeterminate"));height=s(()=>{let t=e=>e.children?.reduce((n,i)=>n+t(i),1)??1;return t(this.node())*this.#t+"px"});hasCheckbox=s(()=>this.node().checked!==void 0);hasValue=s(()=>this.node().meta!==void 0);isTreeNumberSlider=s(()=>Ce(this.node().meta));isTreeString=s(()=>ge(this.node().meta));isTreeNumber=s(()=>be(this.node().meta));isChecked=s(()=>{let t=this.node().checked;return t&&t()?this.hasChildrens()?this.node().children?.every(e=>{let n=e.checked;return n===void 0||n()===!0})?(N(()=>{t.set(!0)}),!0):(N(()=>{t.set("indeterminate")}),"indeterminate"):t():!1});hasChildrens=s(()=>this.childCount()>0);childCount=s(()=>this.node().children?.length??0);onChangeChecked(t){if(this.node().disabled&&t&&t.long)return;let e=this.node().checked;e&&(t&&t.long?(e&&!e()&&(e.set(!0),this.changed.emit(k(v({},this.node()),{path:[this.node().id]}))),this.setChildsChecked.set(this.setChildsChecked()!==void 0?!this.setChildsChecked():!1)):(this.hasChildrens()&&(e()===!0||e()==="indeterminate")?e.set(!1):e.set(!e()),this.changed.emit(k(v({},this.node()),{path:[this.node().id]}))))}onToggleState(t){if(t&&t.long){this.node().state.set(this.node().state()==="open"?"closed":"open");return}else this.onToggleAllStates()}onToggleAllStates(){let t=this.node().state()==="open"?"closed":"open",e=(n,i)=>{n.state.set(i),n.children?.forEach(r=>e(r,i))};e(this.node(),t)}emitChangesOfChilds(t){this.changed.emit(k(v({},t),{path:[this.node().id,...t.path??[]]}))}onContextMenu(t){t.preventDefault(),this.hasValue()&&this.popover()?.open()}onPopoverEnter(){this.changed.emit(k(v({},this.node()),{path:[this.node().id]})),this.popover()?.close(0)}onKeyDown(t){switch(t.code){case"Space":this.node().disabled||this.onChangeChecked();break;case"Enter":this.hasValue()&&this.popover()?.open();break;case"ArrowRight":this.computedOpen()?this.onFocusFirstChild():this.isChecked()&&this.node().state.set("open");break;case"ArrowLeft":this.hasChildrens()?this.node().state()==="closed"?this.onFocusParent():this.node().state.set("closed"):this.onFocusParent();break;case"ArrowDown":{this.hasChildrens()&&this.computedOpen()?this.onFocusFirstChild():this.onFocusNextNode("down")||this.onFocusNextParent([...this.internalId()]);break}case"ArrowUp":{this.onFocusNextNode("up")||this.onFocusParent();break}case"Home":{this.onFocusFirstRoot();break}case"End":{this.onFocusLastRootChild();break}}}onFocusNextNode(t){let e=[...this.internalId()];if(t==="up"){let i=[...this.internalId()];if(i[i.length-1]-=1,this.#e(i))return!0;e[e.length-1]-=1}else e[e.length-1]+=1;let n=document.getElementById(this.internalIdPrefix+e.join("."));return n?(n.focus(),!0):!1}#e(t){let e=document.getElementById(this.internalIdPrefix+t.join("."));for(;e;){let n=parseInt(e.getAttribute("childrens")??"0"),i=e.getAttribute("open")==="true";if(n>0&&i)t.push(n-1),e=document.getElementById(this.internalIdPrefix+t.join("."));else break}return e?(e.focus(),!0):!1}onFocusFirstChild(){let t=[...this.internalId()];t.push(0);let e=document.getElementById(this.internalIdPrefix+t.join("."));e&&e.focus()}onFocusNextParent(t){if(t.length>0&&(t.pop(),t.length>0)){t[t.length-1]+=1;let e=document.getElementById(this.internalIdPrefix+t.join("."));e?e.focus():this.onFocusNextParent(t)}}onFocusParent(){let t=[...this.internalId()];t.pop();let e=document.getElementById(this.internalIdPrefix+t.join("."));e&&e.focus()}onFocusFirstRoot(){let t=document.getElementById(this.internalIdPrefix+"0");t&&t.focus()}onFocusLastRootChild(){this.#e([this.rootLength()-1])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=L({type:o,selectors:[["global-checkbox-tree-element"]],viewQuery:function(e,n){e&1&&j(n.popover,fe,5),e&2&&H()},hostVars:2,hostBindings:function(e,n){e&2&&w(n.computedClass())},inputs:{node:[1,"node"],internalId:[1,"internalId"],rootLength:[1,"rootLength"],setChecked:[1,"setChecked"],isVisible:[1,"isVisible"],metaVisibility:[1,"metaVisibility"]},outputs:{node:"nodeChange",changed:"changed"},decls:18,vars:11,consts:[["popoverComponentId",""],[1,"flex","-translate-x-2.5","items-center"],["hlm","","LongPress","","name","featherChevronRight",1,"mr-1","min-w-6","duration-300",3,"rotate-90"],[1,"min-h-6","min-w-7"],[1,"flex","w-full","items-center","justify-start",3,"sideOffset"],["LongPress","",1,"focus:ring-ring","focus:ring-offset-background","rounded-sm","outline-hidden","focus:ring-2","focus:ring-offset-2",3,"auxclick","keydown","longclick","id","tabindex"],["brnPopoverTrigger","",1,"pointer-events-none","invisible","absolute","-z-50"],["LabelContainer","","variant","horizontal"],[1,"pointer-events-none",3,"disabled","checked"],["inert","","hlmLabel","",1,"pointer-events-none","truncate","select-none"],["inert","","hlmLabel","",1,"pointer-events-none","truncate","text-xs","opacity-70","select-none"],["hlmPopoverContent","",3,"keydown.enter",4,"brnPopoverContent"],["hlm","","LongPress","","name","featherChevronRight",1,"mr-1","min-w-6","duration-300",3,"longclick"],[1,"elite-text-tiny","text-muted-foreground","pl-2","select-none"],["hlmPopoverContent","",3,"keydown.enter"],[3,"value","step","wheelStep","label","hideButtons","hideReset","disabled","max","min","hideDeleteButton"],["hlmLabel",""],[3,"valueChange","value","step","wheelStep","label","hideButtons","hideReset","disabled","max","min","hideDeleteButton"],["hlmInput","","size","sm","spellcheck","false","autocomplete","false",3,"ngModelChange","ngModel","type","disabled","placeholder"],["hlmInput","","size","sm","spellcheck","false","autocomplete","false","type","number",3,"ngModelChange","ngModel","min","max","disabled","placeholder"],[3,"changed","node","internalId","rootLength","isVisible","setChecked","metaVisibility"]],template:function(e,n){if(e&1){let i=p();a(0,"div",1),C(1,xe,1,2,"ng-icon",2)(2,ve,1,0,"div",3),a(3,"brn-popover",4,0)(5,"button",5),y("auxclick",function(x){return m(i),h(n.onContextMenu(x))})("keydown",function(x){return m(i),h(n.onKeyDown(x))})("longclick",function(x){return m(i),h(n.onChangeChecked(x))}),T(6,"button",6),a(7,"div",7),C(8,ke,1,2,"hlm-checkbox",8),a(9,"label",9),b(10),c(),C(11,ye,2,1,"label",10),c()(),S(12,we,1,1),M(13,12),D(),B(15,Se,2,1,"div",11),c()(),R(16,De,3,0,null,null,A)}e&2&&(l(),g(n.hasChildrens()?1:2),l(2),u("sideOffset",32),l(2),w(n.node().disabled?"cursor-not-allowed opacity-75":"cursor-pointer"),u("id",n.internalIdPrefix+n.internalIdAsString())("tabindex",n.isVisible()?1:-1),O("childrens",n.childCount())("open",n.computedOpen()),l(3),g(n.hasCheckbox()?8:-1),l(2),f(" ",n.node().title," "),l(),g(n.node().secondTitle?11:-1),l(5),W(n.node().children))},dependencies:[J,re,$,ne,ee,ie,oe,te,se,me,X,Z,Y,ce,de,le,ae,he,pe,ue],encapsulation:2,changeDetection:0})};export{P as CheckboxTreeElementComponent};
